<script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js"></script>

<script>

  // We'll use zepto to make Ajax requests to our geoip webservice.
  Zepto(start)

  // Kick things off when the DOM is ready.
  function start() {
    var host = location.origin.replace(/^http/, 'ws') // e.g. "ws://localhost:5000"
    var ws = new WebSocket(host)

    ws.onmessage = function (event) {
      console.log(event.data);
    };

    ws.onerror = function (error) {
      console.error(error);
    };

    ws.onopen = function(event) {
      $.get('/api', function(data) {
        ws.send(JSON.stringify(data))
      })
    };

  }

</script>